---
import { Icon } from 'astro-icon/components';

type Review = { name: string; rating: number; text: string; tag?: string };
type Props = { data: { title: string; items: Review[] } };

const { data } = Astro.props as Props;
---

<section id="resenas" class="container-wide space-y-8 py-16 lg:space-y-12 lg:py-24" data-reveal>
  <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
    <div class="space-y-2">
      <p class="pill w-fit text-[11px] tracking-[0.2em]">Reseñas</p>
      <h2 class="text-4xl leading-tight sm:text-5xl">{data.title}</h2>
      <p class="text-lg text-[var(--charcoal)]/70">
        Experiencias reales de pacientes que valoran el detalle y los resultados.
      </p>
    </div>
    <div class="flex items-center gap-2 rounded-full bg-white/80 px-4 py-2 text-sm text-[var(--charcoal)]/70 ring-1 ring-[rgba(176,128,80,0.2)]">
      <Icon name="lucide:star" class="h-4 w-4 text-[var(--goldLight)]" stroke-width="0" fill="currentColor" />
      5.0 / 5 · Pacientes felices
    </div>
  </div>

  <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
    {data.items.map((review, idx) => (
      <article
        class="card flex h-full flex-col gap-4 p-7 reveal-on-scroll"
        data-reveal
        data-reveal-delay={`${idx * 140}ms`}
      >
        <div class="flex flex-wrap items-center gap-3">
          <div class="min-w-0">
            <p class="text-base font-semibold text-[var(--charcoal)]">{review.name}</p>
            {review.tag && <p class="text-xs uppercase tracking-[0.16em] text-[var(--goldLight)]">{review.tag}</p>}
          </div>
          <div class="ml-auto flex items-center gap-2 rounded-full bg-white/70 px-2.5 py-1 text-xs text-[var(--charcoal)]/70 ring-1 ring-[rgba(176,128,80,0.18)]">
            <div
              class="flex items-center gap-1 text-[var(--goldLight)]"
              aria-label={`Calificaci\u00f3n ${review.rating.toFixed(1)} de 5`}
              role="img"
            >
              {Array.from({ length: 5 }).map((_, index) => (
                <Icon
                  name="lucide:star"
                  class={`h-3.5 w-3.5 sm:h-4 sm:w-4 ${index < review.rating ? "opacity-100" : "opacity-30"}`}
                  stroke-width="0"
                  fill="currentColor"
                  aria-hidden="true"
                />
              ))}
            </div>
            <span class="font-semibold text-[var(--charcoal)]/80">{review.rating.toFixed(1)}</span>
            <span class="text-[10px] text-[var(--charcoal)]/55">/ 5</span>
          </div>
        </div>
        <p class="text-base leading-relaxed text-[var(--charcoal)]/75">{review.text}</p>
        <div class="mt-auto flex items-center gap-2 text-xs text-[var(--charcoal)]/60">
          <span class="h-2 w-2 rounded-full bg-[var(--goldLight)]" />
          Seguimiento post atención incluido
        </div>
      </article>
    ))}
  </div>
</section>
