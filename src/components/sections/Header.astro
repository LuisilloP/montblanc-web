---
type NavItem = { label: string; href: string };

type Props = {
  brand: { name: string; tagline?: string };
  nav: NavItem[];
  whatsapp: string;
  ctaLabel: string;
};

const { brand, nav = [], whatsapp, ctaLabel } = Astro.props as Props;
---

<header class="fixed inset-x-0 top-0 z-40 border-b border-[rgba(32,32,32,0.07)] bg-[rgba(248,240,232,0.85)] backdrop-blur-xl">
  <div class="container-wide flex items-center justify-between py-5">
    <a href="#inicio" class="flex items-center gap-3" aria-label="Volver al inicio">
      <div class="pill">Clínica</div>
      <div>
        <div class="text-xs uppercase tracking-[0.38em] text-[var(--goldLight)]">MONT BLANC</div>
        <div class="text-sm font-medium text-[var(--charcoal)]">{brand.tagline}</div>
      </div>
    </a>

    <nav class="hidden items-center gap-8 text-sm font-medium text-[var(--charcoal)] lg:flex" aria-label="Navegación principal">
      {nav.map((item) => (
        <a class="transition hover:text-[var(--goldLight)]" href={item.href}>{item.label}</a>
      ))}
      <a
        class="btn-primary"
        href={whatsapp}
        aria-label="Agendar atención por WhatsApp"
        target="_blank"
        rel="noreferrer"
      >
        {ctaLabel}
      </a>
    </nav>

    <div class="flex items-center gap-3 lg:hidden">
      <a
        href={whatsapp}
        class="hidden rounded-full bg-[var(--gold)] px-4 py-2 text-xs font-semibold text-white shadow-sm sm:inline-flex"
        aria-label="Agendar atención por WhatsApp"
        target="_blank"
        rel="noreferrer"
      >
        WhatsApp
      </a>
      <button
        type="button"
        data-menu-button
        class="rounded-full border border-[rgba(32,32,32,0.12)] bg-white/70 p-2 shadow-sm"
        aria-label="Abrir menú"
        aria-expanded="false"
      >
        <span class="sr-only">Abrir menú</span>
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-[var(--charcoal)]" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 7h16M4 12h16M4 17h16" />
        </svg>
      </button>
    </div>
  </div>

  <div
    data-menu
    class="hidden border-t border-[rgba(32,32,32,0.07)] bg-[rgba(248,240,232,0.95)] px-6 py-4 backdrop-blur lg:hidden"
  >
    <div class="container-wide flex flex-col gap-4">
      {nav.map((item) => (
        <a class="text-base font-medium text-[var(--charcoal)] hover:text-[var(--goldLight)]" href={item.href}>{item.label}</a>
      ))}
      <a
        class="btn-primary w-full justify-center"
        href={whatsapp}
        aria-label="Agendar atención por WhatsApp"
        target="_blank"
        rel="noreferrer"
      >
        {ctaLabel}
      </a>
    </div>
  </div>

  <script>
    const menuButton = document.querySelector("[data-menu-button]");
    const menu = document.querySelector("[data-menu]");

    const closeMenu = () => {
      menu?.classList.add("hidden");
      menuButton?.setAttribute("aria-expanded", "false");
    };

    menuButton?.addEventListener("click", () => {
      const isHidden = menu?.classList.contains("hidden");
      if (isHidden) {
        menu?.classList.remove("hidden");
        menuButton.setAttribute("aria-expanded", "true");
      } else {
        closeMenu();
      }
    });

    menu?.querySelectorAll("a").forEach((link) => {
      link.addEventListener("click", () => closeMenu());
    });

    window.addEventListener("resize", () => {
      if (window.innerWidth >= 1024) {
        closeMenu();
      }
    });
  </script>
</header>
