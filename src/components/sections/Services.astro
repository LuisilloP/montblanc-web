---
import { Icon } from 'astro-icon/components';

type Service = {
  name: string;
  description: string;
  detail?: string;
  tag?: string;
  tagTone?: "amber" | "blue" | "indigo" | "green" | "rose" | "neutral";
  tagIcon?: string;
  cta: string;
  ctaHref?: string;
  image: string;
  alt?: string;
};

type Props = {
  data: {
    title: string;
    subtitle: string;
    ctaHref?: string;
    items: Service[];
  };
};

const { data } = Astro.props as Props;

const tagToneClasses: Record<string, string> = {
  amber:
    "bg-[rgba(176,128,80,0.9)] text-white ring-[rgba(176,128,80,0.95)] shadow-[0_12px_28px_rgba(176,128,80,0.28)]",
  blue:
    "bg-[rgba(66,135,245,0.9)] text-white ring-[rgba(66,135,245,0.95)] shadow-[0_12px_28px_rgba(66,135,245,0.22)]",
  indigo:
    "bg-[rgba(99,102,241,0.9)] text-white ring-[rgba(99,102,241,0.95)] shadow-[0_12px_28px_rgba(99,102,241,0.24)]",
  green:
    "bg-[rgba(16,158,110,0.9)] text-white ring-[rgba(16,158,110,0.95)] shadow-[0_12px_28px_rgba(16,158,110,0.22)]",
  rose:
    "bg-[rgba(225,29,72,0.9)] text-white ring-[rgba(225,29,72,0.95)] shadow-[0_12px_28px_rgba(225,29,72,0.26)]",
  // Nuevos colores aÃ±adidos
  cyan: 
    "bg-[rgba(6,182,212,0.9)] text-white ring-[rgba(6,182,212,0.95)] shadow-[0_12px_28px_rgba(6,182,212,0.22)]",
  orange: 
    "bg-[rgba(249,115,22,0.9)] text-white ring-[rgba(249,115,22,0.95)] shadow-[0_12px_28px_rgba(249,115,22,0.24)]",
  sky: 
    "bg-[rgba(14,165,233,0.9)] text-white ring-[rgba(14,165,233,0.95)] shadow-[0_12px_28px_rgba(14,165,233,0.22)]",
  emerald: 
    "bg-[rgba(16,185,129,0.9)] text-white ring-[rgba(16,185,129,0.95)] shadow-[0_12px_28px_rgba(16,185,129,0.22)]",
  //
  neutral: "bg-white text-[var(--charcoal)] ring-[rgba(32,32,32,0.16)] shadow-[0_12px_28px_rgba(32,32,32,0.12)]",
};
const tagToneClass = (tone?: string) => tagToneClasses[tone ?? "neutral"] ?? tagToneClasses.neutral;
const getCtaHref = (item: Service) => item.ctaHref ?? data.ctaHref ?? "#";
---

<section id="servicios" class="relative overflow-hidden py-16 lg:py-24" data-reveal>
  <div
    class="absolute inset-0 bg-[radial-gradient(circle_at_16%_12%,rgba(176,128,80,0.08),transparent_28%),radial-gradient(circle_at_82%_22%,rgba(168,120,63,0.08),transparent_26%),linear-gradient(180deg,rgba(248,232,224,0.65),rgba(248,232,224,0.42))]"
    aria-hidden="true"
  ></div>

  <div class="container-wide relative space-y-10 lg:space-y-14">
    <div class="max-w-4xl space-y-4">
      <p class="pill w-fit text-[11px] tracking-[0.2em]">Servicios</p>
      <h2 class="text-4xl leading-tight sm:text-5xl">{data.title}</h2>
      <p class="text-lg leading-relaxed text-[var(--charcoal)]/75 sm:text-xl">{data.subtitle}</p>
    </div>

    <div class="grid gap-6 md:grid-cols-2 xl:grid-cols-3">
      {data.items.map((service, idx) => (
        <article
          class="group overflow-hidden rounded-[26px] bg-white/92 shadow-[0_20px_60px_rgba(32,32,32,0.1)] ring-1 ring-[rgba(176,128,80,0.18)] transition duration-200 hover:-translate-y-1 hover:shadow-[0_26px_70px_rgba(32,32,32,0.14)] reveal-on-scroll"
          data-reveal
          data-reveal-delay={`${idx * 140}ms`}
        >
          <div class="relative overflow-hidden">
            <img
              src={service.image}
              alt={service.alt ?? service.name}
              loading="lazy"
              decoding="async"
              class="h-full w-full object-cover transition duration-300 group-hover:scale-[1.02]"
              style="aspect-ratio: 4 / 3;"
            />
            {service.tag && (
              <span
                class={`absolute left-4 top-4 inline-flex items-center gap-2 rounded-full px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.2em] ring-1 backdrop-blur ${tagToneClass(service.tagTone)}`}
              >
              <span
                class="inline-flex h-5 w-5 items-center justify-center rounded-full bg-white/70 text-[var(--goldLight)] ring-1 ring-white/70"
                aria-hidden="true"
              >
                <Icon name={service.tagIcon ?? "lucide:sparkles"} class="h-3.5 w-3.5" stroke-width="1.6" />
              </span>
              {service.tag}
            </span>
          )}
          </div>

          <div class="flex flex-col gap-4 px-5 pb-6 pt-5 sm:px-6 sm:pb-7 sm:pt-6">
            <div class="space-y-2">
              <h3 class="text-2xl leading-tight text-[var(--charcoal)]">{service.name}</h3>
              <p class="text-base leading-relaxed text-[var(--charcoal)]/75">{service.description}</p>
            </div>

            {service.detail && (
              <p class="flex items-center gap-2 text-sm text-[var(--charcoal)]/70">
                <span class="mt-[2px] h-1.5 w-1.5 rounded-full bg-[var(--goldLight)]" />
                <span>{service.detail}</span>
              </p>
            )}

            <div class="mt-auto pt-1">
              <a
                class="group/cta inline-flex w-full items-center justify-between rounded-full border border-[rgba(176,128,80,0.32)] bg-[rgba(248,232,224,0.7)] px-5 py-3 text-[var(--goldDeep)] font-semibold transition hover:-translate-y-[1px] hover:shadow-[0_12px_34px_rgba(176,128,80,0.18)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--goldLight)] focus-visible:ring-offset-2 focus-visible:ring-offset-[rgba(248,232,224,0.7)]"
                href={getCtaHref(service)}
                aria-label={service.cta}
                target="_blank"
                rel="noreferrer"
              >
                <span>{service.cta}</span>
                <span
                  class="flex h-9 w-9 items-center justify-center rounded-full border border-[rgba(176,128,80,0.25)] bg-white/95 text-[var(--goldDeep)] transition group-hover/cta:translate-x-[2px] group-hover/cta:-translate-y-[1px]"
                  aria-hidden="true"
                >
                  <Icon name="lucide:arrow-right" class="h-4 w-4" stroke-width="1.6" />
                </span>
              </a>
            </div>
          </div>
        </article>
      ))}
    </div>
  </div>
</section>
