---
type NavItem = { label: string; href: string };
type Social = { label: string; href: string; ariaLabel?: string };
type FooterLink = { label: string; href: string };

type Props = {
  brand: { name: string; tagline?: string };
  contact: {
    phone: string;
    email: string;
    whatsapp: string;
    address: string;
    hours: string;
    emergency?: string;
    mapLink?: string;
  };
  nav: NavItem[];
  footer: { legal: string; links: FooterLink[]; social: Social[] };
};

const { brand, contact, nav = [], footer } = Astro.props as Props;
const mapEmbedSrc =
  "https://www.google.com/maps?q=Clinica+Dental+Mont+Blanc&output=embed";
const mapCtaLink =
  contact.mapLink ?? "https://maps.app.goo.gl/xtKKcUnBm5QzvTuq8";
const socialLinks = [
  {
    label: "Instagram",
    href: "https://www.instagram.com/clinicadental.montblanc/",
    icon: "instagram",
  },
  { label: "Facebook", href: "https://facebook.com", icon: "facebook" },
];
---

<footer id="contacto" class="bg-[rgba(32,32,32,0.92)] text-white">
  <div
    class="container-wide grid gap-12 py-14 lg:grid-cols-[1.1fr_0.9fr] lg:py-20"
  >
    <div class="space-y-8">
      <div class="space-y-4">
        <p class="text-xs uppercase tracking-[0.36em] text-[var(--champagne)]">
          MONT BLANC
        </p>
        <h3 class="text-4xl font-normal">{brand.tagline}</h3>
        <p class="text-base leading-relaxed text-white/70">
          Clínica boutique con enfoque integral en odontología y estética
          facial. Coordinamos diagnósticos, urgencias y planes completos.
        </p>
      </div>

      <div class="grid gap-6 sm:grid-cols-2">
        <div class="space-y-3">
          <p class="text-sm font-semibold text-white/90">Enlaces</p>
          <div class="grid grid-cols-2 gap-2 text-sm text-white/70">
            {
              nav.map((item) => (
                <a class="hover:text-white" href={item.href}>
                  {item.label}
                </a>
              ))
            }
            {
              footer.links.map((item) => (
                <a class="hover:text-white" href={item.href}>
                  {item.label}
                </a>
              ))
            }
          </div>
        </div>
        <div class="space-y-3">
          <p class="text-sm font-semibold text-white/90">Redes</p>
          <div class="flex flex-wrap gap-3">
            {
              socialLinks.map((item) => (
                <a
                  class="inline-flex items-center justify-center gap-2 rounded-full border border-white/20 bg-white/5 px-4 py-2 text-sm font-semibold text-white/90 transition hover:border-white hover:text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[var(--champagne)]"
                  href={item.href}
                  aria-label={item.label}
                  target="_blank"
                  rel="noreferrer"
                >
                  {item.icon === "instagram" ? (
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-5 w-5"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.6"
                    >
                      <rect x="4" y="4" width="16" height="16" rx="5" ry="5" />
                      <path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0-6 0" />
                      <circle cx="17" cy="7" r="0.9" fill="currentColor" />
                    </svg>
                  ) : (
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-5 w-5"
                      viewBox="0 0 24 24"
                      fill="currentColor"
                    >
                      <path d="M13.4 10.5V8.9c0-.8.2-1.2 1.3-1.2H16V5h-2.1c-2.5 0-3.5 1.1-3.5 3.2v2.3H9v2.8h1.5V20h2.9v-6.7H16l.3-2.8h-2.9z" />
                    </svg>
                  )}
                  <span class="sr-only">{item.label}</span>
                </a>
              ))
            }
          </div>
        </div>
      </div>
    </div>

    <div class="space-y-6">
      <div id="ubicacion" class="space-y-3">
        <div class="space-y-1">
          <p
            class="text-[11px] font-semibold uppercase tracking-[0.24em] text-[var(--champagne)]"
          >
            Ubicación
          </p>
          <h4 class="text-2xl font-semibold">Cómo llegar</h4>
          <p class="text-sm text-white/70">Edificio Arenas · Oficina 316B</p>
        </div>
        <div
          class="rounded-2xl border border-white/15 bg-white/5 p-3 shadow-[0_18px_45px_rgba(0,0,0,0.24)] backdrop-blur-sm"
        >
          <div
            data-map-container
            class="relative aspect-[16/10] overflow-hidden rounded-[18px] border border-white/20 bg-gradient-to-br from-white/12 via-white/10 to-[rgba(201,181,151,0.12)] shadow-inner"
          >
            <div
              class="absolute inset-0 flex flex-col items-center justify-center gap-3 text-center text-white/80"
            >
              <div
                class="flex h-14 w-14 items-center justify-center rounded-full bg-white/12 ring-1 ring-white/25 backdrop-blur-[3px]"
                aria-hidden="true"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-6 w-6"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.8"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M12 21s6-4.35 6-10a6 6 0 10-12 0c0 5.65 6 10 6 10z"
                  ></path>
                  <circle cx="12" cy="11" r="2.5"></circle>
                </svg>
              </div>
              <div class="space-y-1">
                <p class="text-base font-semibold text-white">
                  Mapa listo para cargar
                </p>
                <p class="text-sm text-white/70">
                  Click para cargar Google Maps (mejor performance).
                </p>
              </div>
              <button
                type="button"
                data-map-load
                class="inline-flex items-center gap-2 rounded-full bg-white px-4 py-2 text-sm font-semibold text-[var(--charcoal)] shadow-[0_10px_30px_rgba(0,0,0,0.18)] ring-1 ring-white/40 transition hover:-translate-y-[1px] hover:shadow-[0_16px_40px_rgba(0,0,0,0.24)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[var(--champagne)]"
                aria-label="Cargar mapa de Google"
              >
                Ver mapa
              </button>
            </div>
          </div>
          <div class="mt-3 flex flex-wrap items-center justify-between gap-3">
            <div class="text-sm text-white/70">
              <p>{contact.address}</p>
              <p class="text-white/60">Horario: {contact.hours}</p>
            </div>
            <a
              href={mapCtaLink}
              class="inline-flex items-center gap-2 rounded-full border border-white/30 px-4 py-2 text-sm font-semibold text-white/90 transition hover:border-white hover:text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[var(--champagne)]"
              target="_blank"
              rel="noreferrer"
            >
              Abrir en Google Maps
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="gold-divider opacity-50"></div>
  <div
    class="container-wide flex flex-col gap-2 py-5 text-xs text-white/60 sm:flex-row sm:items-center sm:justify-between"
  >
    <p>{footer.legal}</p>
    <p>Diseño listo para contenido real · Optimizado para rendimiento</p>
  </div>
</footer>

<script define:vars={{ mapEmbedSrc }}>
  const MAP_EMBED_SRC = mapEmbedSrc;
  const mapContainer = document.querySelector("[data-map-container]");
  const loadBtn = document.querySelector("[data-map-load]");
  let mapLoaded = false;

  const loadMap = () => {
    if (!mapContainer || mapLoaded) return;
    mapLoaded = true;
    const iframe = document.createElement("iframe");
    iframe.src = MAP_EMBED_SRC;
    iframe.title = "Mapa ubicación MONT BLANC";
    iframe.setAttribute("aria-label", "Mapa ubicación MONT BLANC");
    iframe.loading = "lazy";
    iframe.referrerPolicy = "no-referrer-when-downgrade";
    iframe.className = "h-full w-full";
    iframe.allowFullscreen = true;
    iframe.style.border = "0";
    iframe.style.position = "absolute";
    iframe.style.inset = "0";
    mapContainer.innerHTML = "";
    mapContainer.appendChild(iframe);
  };

  loadBtn?.addEventListener("click", loadMap);
</script>
